## アプリケーション仕様書： Word Keeper

### 1. 概要

Word Keeper は、英単語学習をゲーミフィケーションの要素を取り入れて楽しく継続できるように設計された Web アプリケーションです。利用者は「魔法言語学者」となり、「古文書の解読（クイズ）」を通じて英単語を学びます。正しく詠唱（入力）できた単語は「ワーズ・グリモワール（単語帳）」に記録され、集めた単語の力を使って「忘却の遺跡（ダンジョン）」のモンスターと戦うことができます。学習の継続を促すために、連続学習日数の記録機能も備わっています。

### 2. 技術スタック

- **フロントエンドフレームワーク:** React 19.1.1
- **ビルドツール:** Vite 7.1.2
- **言語:** TypeScript 5.8.3
- **状態管理:** Zustand 5.0.8
- **UI コンポーネント:** shadcn/ui をベースとしたカスタムコンポーネント（Dialog, Progress, Button など）
- **スタイリング:** Tailwind CSS
- **アニメーション:** framer-motion, motion/react

### 3. 主要機能と画面構成

アプリケーションは主に 4 つのページで構成されています。

#### 3.1. ダッシュボード (Dashboard)

- **ファイル:** `src/pages/Dashboard.tsx`
- **目的:** アプリケーションのハブとなる開始ページ。
- **機能:**
  - 連続研究日数（学習継続日数）を表示します。
  - 「今日の古文書を解読する」ボタン：クイズページへ遷移します。
  - 「忘却の遺跡に挑む」ボタン：ダンジョンページへ遷移します。
  - 「ワーズ・グリモワールを見る」ボタン：ライブラリページへ遷移します。

#### 3.2. 古文書の解読 (QuizPage)

- **ファイル:** `src/pages/QuizPage.tsx`, `src/components/Quiz/*`
- **目的:** 英単語のスペリングクイズを通じて単語を学習する。
- **機能:**
  - 出題される単語が画面中央に表示されます。
  - 入力フィールドに表示された単語のスペルを入力します。
  - 正解すると次の単語が出題され、プログレスバーが進みます。
  - 正解した単語はライブラリ（単語帳）に追加されます。
  - 全ての単語に正解すると「今日の研究完了！🎉」というモーダルが表示され、連続学習日数が 1 日増加します。

#### 3.3. ワーズ・グリモワール (LibraryPage)

- **ファイル:** `src/pages/LibraryPage.tsx`, `src/components/Library/*`
- **目的:** クイズで正解した（収集した）単語を確認する。
- **機能:**
  - 全単語がグリッド状に表示されます。
  - 収集済みの単語は緑色のカードで表示され、未収集の単語はグレーのカードで「???」と表示されます。
  - 単語が収集されると、カードがアニメーションします。

#### 3.4. 忘却の遺跡 (DungeonPage)

- **ファイル:** `src/pages/DungeonPage.tsx`, `src/components/Dungeon/*`
- **目的:** 収集した単語を使ってモンスターと戦うゲームモード。
- **機能:**
  - **挑戦条件:** ライブラリに 4 つ以上の単語が収集されている必要があります。
  - **バトル:**
    - モンスター「忘却の獣（リヴァイア）」が出現し、HP が表示されます。
    - 収集した単語の中からランダムに 1 つの日本語訳が出題されます。
    - 4 つの英単語の選択肢が表示され、正しいスペルを選択します。
    - 正解するとモンスターに 20 ダメージを与え、次の問題が出題されます。
    - 不正解するとバトルは終了し、結果画面が表示されます。
  - **結果:**
    - 不正解だった場合、「詠唱失敗...」と表示され、間違えた単語が提示されます。
    - 「もう一度挑戦する」か「書斎に戻る」かを選択できます。

### 4. 状態管理 (Zustand Stores)

各機能の状態は Zustand のストアによって管理され、`localStorage`に永続化されます。

- **`quizStore.ts`**:

  - `currentWordIndex`: 現在のクイズの単語インデックス。
  - `correctWords`: 正解した単語のリスト。
  - `words`: クイズ対象の全単語リスト。
  - `nextWord()`: 次の単語に進む。
  - `markCorrect()`: 単語を正解として記録する。
  - `resetQuiz()`: クイズの状態をリセットする。

- **`libraryStore.ts`**:

  - `collectedWords`: 収集した単語のリスト。
  - `addWord()`: 新しい単語をリストに追加する（重複はしない）。

- **`streakStore.ts`**:

  - `streak`: 連続学習日数。
  - `lastDate`: 最後に学習した日付。
  - `incrementStreak()`: 1 日に 1 回だけ連続日数をインクリメントする。

- **`dungeonStore.ts`**:
  - `monster`: 現在のモンスターの状態（HP など）。
  - `challengeWord`: 現在出題されている単語とその和訳。
  - `choices`: 4 つの選択肢。
  - `isBattle`, `isGameOver`: バトルの状態フラグ。
  - `startBattle()`: バトルを開始し、モンスターと最初の問題をセットアップする。
  - `handleCorrectAnswer()`: 正解時の処理。モンスターにダメージを与え、次の問題を設定する。
  - `handleIncorrectAnswer()`: 不正解時の処理。ゲームオーバー状態にする。

### 5. データソース

- **ファイル:** `src/data/word_data.json`
- **内容:** アプリケーションで使用される英単語のリスト。各単語には以下の情報が含まれています。
  - `word`: 英単語のスペル
  - `Rank`: ランク
  - `part_of_speech`: 品詞
  - `translation`: 日本語訳
  - `pronunciation`: 発音記号

この JSON ファイルが、クイズの問題、ライブラリの表示、ダンジョンでの出題の元データとなります。
